<!doctype html>
<html>
<head>
<script>
  'use strict'
  window.onload = () => {
    const stdusr = document.createElement('input')
    stdusr.history = [] // toss morrow

    stdusr.prompt = ''  // need morrow

    function browseCommandHistory(keyCode, history) {
      const cron = keyCode === 38 ?
        [ ...new Set(history) ].reverse() : [ ...new Set(history) ]
      const position = cron.indexOf(stdusr.prompt)
      if (cron.length && !stdusr.prompt) {
        stdusr.value = stdusr.prompt = cron[0]
      } else if (position !== -1 && cron[position + 1]) {
        stdusr.value = stdusr.prompt = cron[position + 1]
      }
      stdusr.setSelectionRange(stdusr.value.length, stdusr.value.length)
    }

    stdusr.onkeydown = e => { // aka usrInputHandler
      
      // on every keydown snatch usr cmd history from sessionStorage
      // const usr_cmds = getFromSessionStorage(...)
      //   .filter(msg => msg.from === 'usr')
      //   .map(msg => msg.response.text)
      if (e.keyCode === 13) {              // toss first if block morrow
        stdusr.history.push(stdusr.value) // toss
        stdusr.value = ''                // toss
      } else if (e.keyCode === 38) {
        e.preventDefault()
        browseCommandHistory(e.keyCode, stdusr.history) // stdusr.hsitory aka usr_cmds
      } else if (e.keyCode === 40) {
        browseCommandHistory(e.keyCode, stdusr.history)
      } else if (e.keyCode === 27) {
        stdusr.value = stdusr.prompt = ''
      }
      
    }

    document.body.appendChild(stdusr)
  }
</script>
</head>
<body></body>
</html>